version: 2
jobs:
  arch:
    docker:
      - image: archlinux/base
    steps:
      - checkout
      - run: |
          pacman --noconfirm --refresh --sync cmake clang enchant make
          mkdir build
          cd build
          cmake -DCMAKE_INSTALL_PREFIX="$HOME" ..
          make
          make test
          make check
          make install
          make installcheck
  debian:
    docker:
      - image: debian
    steps:
      - checkout
      - run: |
          apt-get update
          apt-get install -y build-essential cmake libenchant-dev
          mkdir build
          cd build
          cmake -DCMAKE_INSTALL_PREFIX="$HOME" ..
          make
          make test
          make check
          make install
          make installcheck
  fedora:
    docker:
      - image: fedora
    steps:
      - checkout
      - run: |
          dnf -y install cmake enchant-devel gcc
          mkdir build
          cd build
          cmake -DCMAKE_INSTALL_PREFIX="$HOME" ..
          make
          make test
          make check
          make install
          make installcheck
  macos:
    macos:
      xcode: "9.2.0"
    steps:
      - checkout
      - run: |
          brew install cmake enchant
          mkdir build
          cd build
          cmake -DCMAKE_INSTALL_PREFIX="$HOME" ..
          make
          make test
          make check
          make install
          make installcheck
workflows:
  version: 2
  workflow:
    jobs:
      # arch
      - debian
      - fedora
      - macos
